import{d as q,o as r,c,r as F,n as N,a as g,b as J,e as v,f as d,F as b,g as y,h as S,w as x,i as C,j as k,t as I,k as w,v as V,l as B,m as j,p as $,q as A}from"./index-CuLx5365.js";const O=q("itemStore",{state:()=>({items:[],selectedItems:[]}),actions:{setItems(i){this.items=i},clearItems(){this.items=[],this.selectedItems=[]},setSelectedItems(i){this.selectedItems=i},clearSelectedItems(){this.selectedItems=[]}}}),T=(i,t)=>{const l=i.__vccOpts||i;for(const[e,_]of t)l[e]=_;return l},M={name:"ThemedButton",props:{disabled:{type:Boolean,default:!1},fullWidth:{type:Boolean,default:!1}},emits:["click"],methods:{handleClick(i){this.disabled||this.$emit("click",i)}}},U=["disabled"];function Q(i,t,l,e,_,f){return r(),c("button",{class:N(["themed-button",{"is-full-width":l.fullWidth}]),disabled:l.disabled,onClick:t[0]||(t[0]=(...n)=>f.handleClick&&f.handleClick(...n))},[F(i.$slots,"default")],10,U)}const D=T(M,[["render",Q]]),z={name:"FilterableChecklist",components:{ThemedButton:D},props:{categories:{type:Array,required:!0},items:{type:Array,required:!0}},setup(i){const t=O(),l=g([]),e=J(new Set),_=g(i.categories),f=v(()=>_.value.reduce((a,o)=>{const{section:h,name:p,id:L}=o;return a[h]||(a[h]=[]),a[h].push({name:p,id:L}),a},{}));return{sectionGroups:v(()=>{const a=Object.entries(f.value),o=Math.ceil(a.length/3);return[Object.fromEntries(a.slice(0,o)),Object.fromEntries(a.slice(o,o*2)),Object.fromEntries(a.slice(o*2))]}),selectedCategories:l,expandedSections:e,toggleSection:a=>{e.has(a)?e.delete(a):e.add(a)},fetchItems:()=>{const a=l.value.map(p=>p.id),o=i.items.filter(p=>a.includes(p.id_category)&&p.price_buy>0),h=[];o.forEach(p=>{h.some(E=>E.item_name===p.item_name)||h.push(p)}),t.setItems(h),e.clear()},resetList:()=>{l.value=[],t.clearItems(),e.clear()}}}},G={class:"filterable-checklist"},R=["onClick"],W={class:"checklist"},P=["value"],H={class:"button-container"};function K(i,t,l,e,_,f){const n=C("ThemedButton");return r(),c("div",G,[t[3]||(t[3]=d("h3",null,"Select Categories",-1)),(r(!0),c(b,null,y(e.sectionGroups,(s,u)=>(r(),c("div",{key:u,class:"group"},[(r(!0),c(b,null,y(s,(m,a)=>(r(),c("div",{key:a,class:"section-group"},[d("h4",{onClick:o=>e.toggleSection(a)},[d("span",{class:N(["arrow",{open:e.expandedSections.has(a)}])},"â–¶",2),k(" "+I(a),1)],8,R),w(d("ul",W,[(r(!0),c(b,null,y(m,o=>(r(),c("li",{key:o.id,class:"checklist-item"},[d("label",null,[w(d("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=h=>e.selectedCategories=h),value:o},null,8,P),[[B,e.selectedCategories]]),d("span",null,I(o.name),1)])]))),128))],512),[[V,e.expandedSections.has(a)]])]))),128))]))),128)),d("div",H,[S(n,{onClick:e.fetchItems},{default:x(()=>t[1]||(t[1]=[k("Show Items")])),_:1},8,["onClick"]),S(n,{onClick:e.resetList},{default:x(()=>t[2]||(t[2]=[k("Reset List")])),_:1},8,["onClick"])])])}const X=T(z,[["render",K],["__scopeId","data-v-c8861ce1"]]),Y={name:"ItemSearchList",components:{ThemedButton:D},setup(){const i=O(),t=g(""),l=g(""),e=g([]);let _=null;const f=()=>{clearTimeout(_),_=setTimeout(()=>{l.value=t.value},1e3)},n=v(()=>l.value.trim()===""?i.items.filter(m=>e.value.some(a=>a.item_name===m.item_name)):i.items.filter(m=>m.item_name.toLowerCase().includes(l.value.toLowerCase())));return{itemStore:i,searchQuery:t,selectedItems:e,filteredItems:n,handleInput:f,updateStoredItems:()=>{const m=i.items.filter(a=>e.value.includes(a.item_name));i.setSelectedItems(m)},resetStoredItems:()=>{e.value=[],t.value="",l.value="",i.clearSelectedItems()}}}},Z=["disabled"],ee={class:"item-list"},te=["value"],se={key:0},ne={class:"button-container"};function ie(i,t,l,e,_,f){const n=C("ThemedButton");return r(),c("div",{class:N(["item-search-list",{"is-disabled":!e.itemStore.items.length}])},[t[5]||(t[5]=d("h3",null,"Search Items from filtered Categories",-1)),w(d("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>e.searchQuery=s),onInput:t[1]||(t[1]=(...s)=>e.handleInput&&e.handleInput(...s)),placeholder:"Search items...",class:"search-bar",disabled:!e.itemStore.items.length},null,40,Z),[[j,e.searchQuery]]),d("ul",ee,[(r(!0),c(b,null,y(e.filteredItems,s=>(r(),c("li",{key:s.id,class:"item"},[d("label",null,[w(d("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=u=>e.selectedItems=u),value:s.item_name},null,8,te),[[B,e.selectedItems]]),k(" "+I(s.item_name),1)])]))),128)),e.filteredItems.length?$("",!0):(r(),c("p",se,"No items found."))]),d("div",ne,[S(n,{disabled:!e.itemStore.items.length||!e.selectedItems.length,onClick:e.updateStoredItems},{default:x(()=>t[3]||(t[3]=[k(" Submit List ")])),_:1},8,["disabled","onClick"]),S(n,{disabled:!e.itemStore.items.length||!e.selectedItems.length,onClick:e.resetStoredItems},{default:x(()=>t[4]||(t[4]=[k(" Reset List ")])),_:1},8,["disabled","onClick"])])],2)}const ae=T(Y,[["render",ie],["__scopeId","data-v-d43f077f"]]),le={name:"TerminalList",props:{terminals:{type:Array,required:!0},items:{type:Array,required:!0}},setup(i){const t=O(),l=v(()=>{const n=t.selectedItems.map(s=>s.item_name);return i.items.filter(s=>n.includes(s.item_name)).filter(s=>s.price_buy>0)}),e=v(()=>{const n={};return l.value.forEach(s=>{n[s.id_terminal]||(n[s.id_terminal]=[]),n[s.id_terminal].push(s)}),Object.keys(n).map(s=>({id_terminal:s,items:n[s]}))});return{sortedTerminals:v(()=>{const n=new Set(l.value.map(m=>m.item_name)),s=[],u=new Set;for(;n.size>0;){let m=null,a=0;if(e.value.forEach(o=>{if(!u.has(o.id_terminal)){const h=o.items.filter(p=>n.has(p.item_name)).length;h>a&&(a=h,m=o)}}),m){const o=m.items.filter(h=>n.has(h.item_name));s.push({id_terminal:m.id_terminal,items:o}),o.forEach(h=>n.delete(h.item_name)),u.add(m.id_terminal)}else break}return s}),getTerminalName:n=>{const s=i.terminals.find(u=>u.id===parseInt(n));return s?s.name:"Unknown Terminal"}}}},oe={class:"terminal-list"},re={key:0},ce={key:1};function me(i,t,l,e,_,f){return r(),c("div",oe,[t[0]||(t[0]=d("h3",null,"Terminal List",-1)),e.sortedTerminals.length?(r(),c("ul",re,[(r(!0),c(b,null,y(e.sortedTerminals,(n,s)=>(r(),c("li",{class:"terminal",key:s},[d("strong",null,I(e.getTerminalName(n.id_terminal))+" ("+I(n.items.length)+" item"+I(n.items.length>1?"s":"")+") ",1),d("ul",null,[(r(!0),c(b,null,y(n.items,u=>(r(),c("li",{class:"item",key:u.item_name},I(u.item_name),1))),128))])]))),128))])):(r(),c("p",ce,"No selected items found."))])}const de=T(le,[["render",me],["__scopeId","data-v-4f700589"]]),ue={components:{FilterableChecklist:X,ItemSearchList:ae,TerminalList:de},setup(){const i=g([]),t=g([]),l=g([]),e=g([]),_=g(!0),f=async()=>{const n={categories:"https://uexcorp.space/api/2.0/categories?type=item",items:"https://uexcorp.space/api/2.0/items_prices_all",terminals:"https://uexcorp.space/api/2.0/terminals?type=item",orbit_distances:"https://uexcorp.space/api/2.0/orbits_distances?id_star_system=68"};try{const s=async p=>(await(await fetch(p)).json()).data,[u,m,a,o]=await Promise.all([s(n.categories),s(n.items),s(n.terminals),s(n.orbit_distances)]);i.value=u,t.value=m,l.value=a,e.value=o,localStorage.setItem("categories",JSON.stringify(u)),localStorage.setItem("items",JSON.stringify(m)),localStorage.setItem("terminals",JSON.stringify(a)),localStorage.setItem("orbit_distances",JSON.stringify(o));const h=Date.now()+24*60*60*1e3;localStorage.setItem("dataExpiration",h.toString())}catch(s){console.error("Error fetching data:",s)}finally{_.value=!1}};return A(async()=>{const n=localStorage.getItem("dataExpiration");!n||Date.now()>Number(n)?await f():(i.value=JSON.parse(localStorage.getItem("categories"))||[],t.value=JSON.parse(localStorage.getItem("items"))||[],l.value=JSON.parse(localStorage.getItem("terminals"))||[],e.value=JSON.parse(localStorage.getItem("orbit_distances"))||[],_.value=!1,console.log("Data loaded from localStorage"))}),{isLoading:_,categories:i,items:t,terminals:l}}},he={key:0,class:"loader-overlay"},_e={key:1};function fe(i,t,l,e,_,f){const n=C("FilterableChecklist"),s=C("ItemSearchList"),u=C("TerminalList");return r(),c("div",null,[t[1]||(t[1]=d("h1",{class:"title"},"Filterable Checklist",-1)),e.isLoading?(r(),c("div",he,t[0]||(t[0]=[d("div",{class:"loader"},null,-1)]))):(r(),c("div",_e,[S(n,{categories:e.categories,items:e.items},null,8,["categories","items"]),S(s),S(u,{terminals:e.terminals,items:e.items},null,8,["terminals","items"])]))])}const ge=T(ue,[["render",fe],["__scopeId","data-v-559820a8"]]);export{ge as default};
